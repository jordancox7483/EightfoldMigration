# Eightfold Migration Helper UI

The repository now includes a Tkinter-based desktop front-end (`migration_gui.py`)
that orchestrates the existing migration utilities. You can launch it directly
with Python or freeze it into a standalone executable for teammates that do not
have Python installed.

> **Executable availability:** Each release publishes `EightfoldMigrationHelper.exe`
> for Windows. It is intended for personal/internal use, considered alpha
> quality, and may not cover every edge case. If the UI misbehaves, re-run the
> underlying Python scripts directly.

## Prerequisites

| Purpose | Command |
| ------- | ------- |
| Base environment | `python -m venv .venv` (optional) |
| Activate on Windows | `.venv\Scripts\Activate.ps1` |
| Install dependencies | `pip install -r test/requirements.txt playwright pyinstaller` |
| Download Playwright Chromium | `python -m playwright install chromium` |

> **Note:** Before building an executable, set the environment variable
> `PLAYWRIGHT_BROWSERS_PATH=playwright-browsers` (or run
> `scripts\build_executable.ps1`, which does this automatically) so the browser
> binaries are packaged alongside the app.

## Launching the UI from source

```powershell
cd EightfoldMigration
python migration_gui.py
```

The window provides five groups of inputs:

1. **Core JSON Inputs** – Select the source/target form and question exports and
   the target configuration JSON you want to audit/update.
2. **Custom Fields Scraper** – Supply the Eightfold custom fields URL, plus the
   username/password used to sign in. Choose an output folder and filename for
   the CSV export (default `source.csv`), then click **Run custom_fields_scraper.py**.
   Run the scraper twice: first against the source environment (save as
   `source.csv`), then against the target environment (save as `target.csv`).
   The script runs in headless mode and writes the CSV to the folder you select.
3. **Custom Field CSV Selection** – Point the UI at the *source* (`source.csv`)
   and *target* (`target.csv`) CSV files generated by the scraper (or any existing
   CSV exports in the same format).
4. **Updated Form/Question Libraries** – Choose an output folder and click
  **Generate updated form & question libraries**. The tool runs
  `form_and_question_id_updater.py` (dry run) to validate mappings and
  `dependency_question_id_updater.py` to write prefixed copies of the target
  forms/questions into the chosen directory.
5. **JSON Rewriter** – Pick an output folder and click **Update selected JSON…**
   to copy the selected configuration JSON, apply the ID mapping pass, and then
   rewrite any `custom_field_id` values using the selected CSVs. The output file
   is named `Updated_<original>.json`.

All actions emit progress and summary details in the log panel at the bottom of
the window. Each run is stateless—re-running the same action with new files will
only touch the selected inputs/outputs.

## Building a standalone executable (Windows)

1. Activate your virtual environment (optional but recommended).
2. Install dependencies from the table above (PyInstaller + Playwright).
3. From the repository root run:

   ```powershell
   scripts\build_executable.ps1
   ```

   - If the Playwright browser bundle is missing, the script downloads Chromium
     into `playwright-browsers/`.
   - PyInstaller emits `dist\EightfoldMigrationHelper.exe`.

4. Copy the executable **and** the `playwright-browsers` folder to the target
   machine. No other installation steps are required.

You can customise the output name:

```powershell
scripts\build_executable.ps1 -Name MigrationUtility
```

## Running the packaged executable

Place the executable next to the `playwright-browsers` directory and double-
click it. The UI mirrors the Python version. All paths you select within the UI
are fully portable; no state is stored between runs.

If the scraper is unable to start because Chromium is missing, verify that the
`playwright-browsers` directory is present beside the executable. You can
rebuild the bundle at any time by re-running the steps in the previous section.
